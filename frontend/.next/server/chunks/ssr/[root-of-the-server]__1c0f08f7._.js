module.exports=[72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},77749,a=>{"use strict";var b=a.i(87924),c=a.i(56025),d=a.i(19032),e=a.i(50944),f=a.i(72131);function g({carId:a}){let g=Number(a),{token:i}=(0,c.useAuth)(),j=(0,e.useRouter)(),[k,l]=(0,f.useState)(null),[m,n]=(0,f.useState)(!0),[o,p]=(0,f.useState)(null),q=(0,f.useMemo)(()=>"http://localhost:5000/api".replace(/\/api$/,""),[]),r=(0,f.useCallback)(a=>a?a.startsWith("http")||a.startsWith("data:")||!q?a:`${q}${a.startsWith("/")?a:`/${a}`}`:"/placeholder-car.svg",[q]);(0,f.useEffect)(()=>{let a=!1;return async function(){if(!Number.isFinite(g)){p("Invalid car identifier."),n(!1);return}try{n(!0);let b=await (0,d.fetchCarById)(g,i);if(!b.success||!b.car)throw Error("Unable to load car");a||(l(b.car),p(null))}catch(b){a||p(b instanceof Error?b.message:"Unable to load car")}finally{a||n(!1)}}(),()=>{a=!0}},[g,i]);let s=k?r(k.image):"/placeholder-car.svg",t=(0,f.useMemo)(()=>{if(!k)return s?[s]:["/placeholder-car.svg"];let a=Array.from(new Set([...(k.mediaGallery||[]).filter(a=>"image"===a.type&&a.url).map(a=>r(a.url)),...(k.galleryImages||[]).map(a=>r(a)),...(k.imageUrls||[]).map(a=>r(a)),s].filter(Boolean)));return k&&(function(a,b){if(!a||b.length>=3)return[];let c=[];for(let d of["front","45","rear"]){if(b.length+c.length>=3)break;let e=function(a,b){if(!a.make||!a.model)return"";let c=new URLSearchParams({customer:"img",make:a.make,modelFamily:a.model,modelRange:a.model,modelYear:String(a.year??new Date().getFullYear()),angle:b,zoomType:"fullscreen",width:"1600"});return`https://cdn.imagin.studio/getImage?${c.toString()}`}(a,d);!e||b.includes(e)||c.includes(e)||c.push(e)}return c})(k,a).forEach(b=>{a.includes(b)||a.push(b)}),a},[k,s,r]),[u,v]=(0,f.useState)(0),[w,x]=(0,f.useState)(!1),[y,z]=(0,f.useState)(0);(0,f.useEffect)(()=>{v(0),z(0)},[t.length]);let A=t[u]||s,B=t.length>1,C=(0,f.useMemo)(()=>k&&(k.videoUrl||k.mediaGallery?.find(a=>"video"===a.type)?.url)||null,[k]),D=(0,f.useMemo)(()=>(function(a){if(!a)return"";let b=a.description?.trim();if(b)return b;let c=[],d=a.year?`${a.year}`:"recent";if(c.push(`This ${d} ${a.make} ${a.model} is fully profiled on IntelliWheels.`),a.specs){let{bodyStyle:b,engine:d,horsepower:e,fuelEconomy:f}=a.specs,g=[];b&&g.push(`${b} body`),d&&g.push(d),e&&g.push(`${e} hp output`),f&&g.push(`rated at ${f}`),g.length&&c.push(`Highlights include ${g.join(", ")}.`)}return a.currency&&a.price&&c.push(`Priced at ${h(a.price,a.currency)}, it is ready for viewing.`),c.join(" ")})(k),[k]),E=a=>{z(a),x(!0)};return((0,f.useEffect)(()=>{if(!w)return;let a=a=>{"Escape"===a.key?x(!1):"ArrowRight"===a.key?z(a=>a===t.length-1?0:a+1):"ArrowLeft"===a.key&&z(a=>0===a?t.length-1:a-1)};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[t.length,w]),m)?(0,b.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-slate-50 text-slate-500",children:"Loading car details..."}):o||!k?(0,b.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-slate-50 px-4",children:(0,b.jsxs)("div",{className:"max-w-md rounded-3xl border border-slate-200 bg-white p-6 text-center shadow",children:[(0,b.jsx)("p",{className:"text-lg font-semibold text-slate-900",children:"Unable to load this car"}),(0,b.jsx)("p",{className:"mt-2 text-sm text-slate-600",children:o||"The requested listing could not be found."}),(0,b.jsx)("button",{type:"button",className:"mt-6 w-full rounded-2xl bg-slate-900 px-4 py-2 text-sm font-semibold text-white",onClick:()=>j.back(),children:"Go back"})]})}):(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-sky-50",children:[(0,b.jsxs)("div",{className:"mx-auto max-w-6xl px-4 py-8",children:[(0,b.jsx)("button",{type:"button",className:"rounded-full border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-700 shadow-sm",onClick:()=>j.back(),children:"← Back to listings"}),(0,b.jsxs)("div",{className:"mt-6 grid gap-6 lg:grid-cols-[2fr,1fr]",children:[(0,b.jsxs)("div",{className:"rounded-3xl border border-slate-100 bg-white shadow-sm",children:[(0,b.jsxs)("div",{className:"relative h-96 w-full overflow-hidden rounded-t-3xl",children:[(0,b.jsx)("img",{src:A,alt:`${k.make} ${k.model}`,className:"h-full w-full cursor-zoom-in object-cover",onClick:()=>E(u)}),(0,b.jsx)("button",{type:"button",className:"absolute right-4 top-4 rounded-full bg-white/90 px-3 py-1 text-xs font-semibold text-slate-900 shadow",onClick:()=>E(u),children:"Full screen"}),B&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{type:"button","aria-label":"Previous image",className:"absolute left-4 top-1/2 -translate-y-1/2 rounded-full bg-white/90 p-3 text-slate-800 shadow",onClick:()=>v(a=>0===a?t.length-1:a-1),children:"‹"}),(0,b.jsx)("button",{type:"button","aria-label":"Next image",className:"absolute right-4 top-1/2 -translate-y-1/2 rounded-full bg-white/90 p-3 text-slate-800 shadow",onClick:()=>v(a=>a===t.length-1?0:a+1),children:"›"})]})]}),B&&(0,b.jsx)("div",{className:"flex flex-wrap gap-2 border-t border-slate-100 p-4",children:t.map((a,c)=>(0,b.jsx)("button",{type:"button",onClick:()=>v(c),className:`h-16 w-16 overflow-hidden rounded-xl border ${c===u?"border-sky-500":"border-slate-200"}`,children:(0,b.jsx)("img",{src:a,alt:`Thumbnail ${c+1}`,className:"h-full w-full object-cover"})},`${a}-${c}`))}),(0,b.jsxs)("div",{className:"space-y-6 p-6",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm uppercase tracking-wide text-slate-400",children:"Listing"}),(0,b.jsxs)("h1",{className:"text-3xl font-bold text-slate-900",children:[k.make," ",k.model]}),(0,b.jsx)("p",{className:"text-slate-500",children:k.year??"Model year TBD"})]}),(0,b.jsxs)("div",{className:"rounded-2xl bg-slate-50 px-4 py-3 text-right",children:[(0,b.jsx)("p",{className:"text-xs uppercase text-slate-400",children:"Price"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-emerald-600",children:h(k.price,k.currency)})]})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-100 p-4",children:[(0,b.jsx)("p",{className:"text-xs uppercase text-slate-400",children:"Rating"}),(0,b.jsx)("p",{className:"text-3xl font-semibold text-slate-900",children:k.rating?k.rating.toFixed(1):"—"})]}),(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-100 p-4",children:[(0,b.jsx)("p",{className:"text-xs uppercase text-slate-400",children:"Reviews"}),(0,b.jsx)("p",{className:"text-3xl font-semibold text-slate-900",children:k.reviews??"—"})]}),k.odometerKm?(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-100 p-4",children:[(0,b.jsx)("p",{className:"text-xs uppercase text-slate-400",children:"Odometer"}),(0,b.jsxs)("p",{className:"text-3xl font-semibold text-slate-900",children:[k.odometerKm.toLocaleString()," km"]})]}):null]}),D&&(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/70 p-5",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Description"}),(0,b.jsx)("p",{className:"mt-2 whitespace-pre-line text-sm leading-relaxed text-slate-700",children:D})]}),k.specs&&(0,b.jsx)("div",{className:"grid gap-3 md:grid-cols-2",children:Object.entries(k.specs).map(([a,c])=>c?(0,b.jsxs)("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-700",children:[(0,b.jsxs)("span",{className:"font-semibold text-slate-900",children:[a.replace(/([A-Z])/g," $1").replace(/_/g," ").replace(/^./,a=>a.toUpperCase()),":"]})," ",String(c)]},a):null)}),C&&(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-100 p-4",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Video spotlight"}),(0,b.jsx)("div",{className:"mt-3 overflow-hidden rounded-2xl border border-slate-200 bg-black/80",children:(a=>{if(!a)return null;let c=a.match(/(?:v=|youtu\.be\/|embed\/)([\w-]+)/i);return c?(0,b.jsx)("iframe",{title:"car-video",src:`https://www.youtube.com/embed/${c[1]}`,className:"h-64 w-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):/\.(mp4|webm|ogg)$/i.test(a)?(0,b.jsx)("video",{controls:!0,src:a,className:"h-64 w-full rounded-2xl object-cover"}):(0,b.jsx)("a",{href:a,target:"_blank",rel:"noreferrer",className:"text-sky-500 underline",children:"Watch video"})})(C)})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,b.jsxs)("div",{className:"rounded-3xl border border-slate-100 bg-white p-6 shadow-sm",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Seller actions"}),(0,b.jsx)("p",{className:"mt-2 text-sm text-slate-600",children:"Ready to discuss this car? Reach out to the IntelliWheels concierge team."}),(0,b.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,b.jsx)("button",{className:"w-full rounded-2xl bg-sky-600 py-2 text-sm font-semibold text-white",children:"Request callback"}),(0,b.jsx)("button",{className:"w-full rounded-2xl border border-slate-200 py-2 text-sm font-semibold text-slate-900",children:"Add to watchlist"}),k.owner_id?(0,b.jsx)("button",{className:"w-full rounded-2xl border border-slate-200 py-2 text-sm font-semibold text-slate-900",onClick:()=>j.push(`/dealers/${k.owner_id}`),children:"Visit dealer page"}):null]})]}),(0,b.jsxs)("div",{className:"rounded-3xl border border-slate-100 bg-white p-6 shadow-sm",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Listing metadata"}),(0,b.jsxs)("ul",{className:"mt-3 space-y-2 text-sm text-slate-600",children:[(0,b.jsxs)("li",{children:["Currency: ",k.currency||"AED"]}),(0,b.jsxs)("li",{children:["Created: ",k.created_at?new Date(k.created_at).toLocaleDateString():"Recently added"]}),k.updated_at&&(0,b.jsxs)("li",{children:["Updated: ",new Date(k.updated_at).toLocaleDateString()]}),k.owner_id&&(0,b.jsxs)("li",{children:["Owner ID: ",k.owner_id]})]})]})]})]})]}),w&&(0,b.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 px-4 py-8",children:[(0,b.jsx)("button",{type:"button",className:"absolute right-6 top-6 rounded-full bg-white/20 px-3 py-1 text-sm font-semibold text-white backdrop-blur",onClick:()=>x(!1),children:"Close ✕"}),t.length>1&&(0,b.jsx)("button",{type:"button","aria-label":"Previous image",className:"absolute left-6 top-1/2 -translate-y-1/2 rounded-full bg-white/20 p-3 text-2xl text-white",onClick:()=>z(a=>0===a?t.length-1:a-1),children:"‹"}),(0,b.jsx)("img",{src:t[y],alt:`Fullscreen ${y+1}`,className:"max-h-[90vh] max-w-5xl rounded-3xl object-contain shadow-2xl"}),t.length>1&&(0,b.jsx)("button",{type:"button","aria-label":"Next image",className:"absolute right-6 top-1/2 -translate-y-1/2 rounded-full bg-white/20 p-3 text-2xl text-white",onClick:()=>z(a=>a===t.length-1?0:a+1),children:"›"}),t.length>1&&(0,b.jsx)("div",{className:"absolute bottom-8 flex max-w-4xl gap-3 overflow-x-auto rounded-2xl bg-white/10 p-3",children:t.map((a,c)=>(0,b.jsx)("button",{type:"button",onClick:()=>z(c),className:`h-16 w-16 overflow-hidden rounded-xl border ${c===y?"border-white":"border-transparent opacity-70"}`,children:(0,b.jsx)("img",{src:a,alt:`Fullscreen thumbnail ${c+1}`,className:"h-full w-full object-cover"})},`${a}-fullscreen-${c}`))})]})]})}function h(a,b="AED"){if(null==a)return"TBD";try{return new Intl.NumberFormat("en-US",{style:"currency",currency:b,maximumFractionDigits:0}).format(a)}catch(c){return`${a.toLocaleString()} ${b}`}}a.s(["CarDetailView",()=>g])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__1c0f08f7._.js.map